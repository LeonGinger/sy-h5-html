;my.defineComponent || (my.defineComponent = Component);(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["components/amazarashi-uploadimg/uploadImg"],{"2c0f":function(e,t,n){"use strict";n.r(t);var a=n("7742"),r=n("5b86");for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n("2c3f");var c,u=n("f0c5"),i=Object(u["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],c);t["default"]=i.exports},"2c3f":function(e,t,n){"use strict";var a=n("a1ce"),r=n.n(a);r.a},"2e9b":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("a34a")),r=o(n("8d2c"));function o(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,a,r,o,c){try{var u=e[o](c),i=u.value}catch(s){return void n(s)}u.done?t(i):Promise.resolve(i).then(a,r)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function u(e){c(o,a,r,u,i,"next",e)}function i(e){c(o,a,r,u,i,"throw",e)}u(void 0)}))}}var i={props:{width:{type:Number,default:300},height:{type:Number,default:190},bgsrc:{type:String},model:{type:String,default:""}},data:function(){return{gifimg:"",currentImage:"",choosed:!1,resImg:"",model:""}},methods:{handleAddNewImage:function(){var t=this;e.chooseImage({count:1,sourceType:["album","camera"],sizeType:["compressed"],success:function(){var e=u(a.default.mark((function e(n){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(n),t.choosed=!0,t.resImg=n.tempFilePaths[0],"iPhone"==t.model){e.next=6;break}return e.next=6,t.detail(t.resImg);case 6:t.$emit("chooseimg",{src:t.resImg});case 7:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()})},detail:function(e){var t=this;return u(a.default.mark((function n(){var r,o,c,u,i;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=500,o=1,n.next=4,t.getImageTag(e,"Orientation",(function(e){void 0!=e&&(o=e)}));case 4:return c=null,u=null,n.next=8,t.comprossImage(e,r,(function(e){c=e.img,u=e.canvas}));case 8:console.log(o,"Orientation"),i="",n.t0=o,n.next=6===n.t0?13:8===n.t0?15:3===n.t0?17:19;break;case 13:return i=t.rotateImg(c,"right",u),n.abrupt("break",21);case 15:return i=t.rotateImg(c,"left",u),n.abrupt("break",21);case 17:return i=t.rotateImg(c,"right",u,2),n.abrupt("break",21);case 19:return i=t.rotateImg(c,"",u),n.abrupt("break",21);case 21:console.log(i,"baseStr");case 22:case"end":return n.stop()}}),n)})))()},comprossImage:function(t,n,r){return u(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return",0);case 2:return n.abrupt("return",new Promise((function(n,a){e.getImageInfo({src:t,success:function(e){var t=new Image;t.src=e.path,console.log(t);var a=document.createElement("canvas"),o=new Object;o.img=t,o.canvas=a,n(r(o))}})})));case 3:case"end":return n.stop()}}),n)})))()},getImageTag:function(t,n,a){return t?new Promise((function(n,o){var c=new Image;c.src=t,console.log("imgObj",c),e.getImageInfo({src:t,success:function(e){r.default.getData(c,(function(){r.default.getAllTags(this);var e=r.default.getTag(this,"Orientation");n(a(e))}))}})})):0},rotateImg:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;console.log("开始旋转");var r=0,o=3;if(null!=e){var c=e.height,u=e.width,i=500,s=u,l=c,f=s/l;console.log(i),s>i&&(s=i,l=Math.floor(s/f)),u=s,c=l;var g=0;null==g&&(g=r),"right"==t?(g+=a,g>o&&(g=r)):"left"==t?(g-=a,g<r&&(g=o)):g=0;var d=90*g*Math.PI/180,m=n.getContext("2d");switch(console.log("degree",d),console.log("step",g),g){case 1:console.log("右旋转 90度"),n.width=c,n.height=u,m.rotate(d),m.drawImage(e,0,-c,u,c);break;case 2:n.width=u,n.height=c,m.rotate(d),m.drawImage(e,-u,-c,u,c);break;case 3:console.log("左旋转 90度"),n.width=c,n.height=u,m.rotate(d),m.drawImage(e,-u,0,u,c);break;default:n.width=u,n.height=c,m.drawImage(e,0,0,u,c);break}var h=n.toDataURL("image/jpeg",1);this.currentImage=h}},uploadImg:function(t){console.log(t,"触发上传接口"),e.uploadFile({url:"服务器地址",filePath:t,fileType:"image",header:{Authorization:"Bearer "+localStorage.getItem("token")},name:"file",success:function(t){e.hideLoading();var n=JSON.parse(t.data);if(200===n.meta.code){var a=n.data.url;console.log(a)}}})}}};t.default=i}).call(this,n("c11b")["default"])},"5b86":function(e,t,n){"use strict";n.r(t);var a=n("2e9b"),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},7742:function(e,t,n){"use strict";var a;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var r=function(){var e=this,t=e.$createElement;e._self._c},o=[]},a1ce:function(e,t,n){}}]);
;(my["webpackJsonp"] = my["webpackJsonp"] || []).push([
    'components/amazarashi-uploadimg/uploadImg-create-component',
    {
        'components/amazarashi-uploadimg/uploadImg-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('c11b')['createComponent'](__webpack_require__("2c0f"))
        })
    },
    [['components/amazarashi-uploadimg/uploadImg-create-component']]
]);
